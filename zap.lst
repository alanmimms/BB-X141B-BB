ZAP	MACRO M1113  14-APR-81 11:46  PAGE 2


      2					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.15	ZAP.B11	PAGE 1
      3
      4					;     	0001	MODULE ZAP(MAIN,IDENT="X04.03")=
      5					;     	0002	BEGIN
      6					;     	0003
      7					;     	0004	!
      8					;     	0005	!
      9					;     	0006	! COPYRIGHT 1975,
     10					;     	0007	! DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
     11					;     	0008	!
     12					;     	0009	! THIS SOFTWARE IS FURNISHED TO PURCHASER UNDER A LICENSE FOR USE
     13					;     	0010	! ON A SINGLE COMPUTER SYSTEM  AND  CAN BE COPIED (WITH INCLUSION
     14					;     	0011	! OF DEC'S COPYRIGHT NOTICE)  ONLY FOR USE IN SUCH SYSTEM, EXCEPT
     15					;     	0012	! AS MAY OTHERWISE BE PROVIDED IN WRITING BY DEC.
     16					;     	0013	!
     17					;     	0014	! THE INFORMATION IN  THIS DOCUMENT IS  SUBJECT TO CHANGE WITHOUT
     18					;     	0015	! NOTICE AND SHOULD NOT  BE CONSTRUED AS  A COMMITMENT BY DIGITAL
     19					;     	0016	! EQUIPMENT CORPORATION.
     20					;     	0017	!
     21					;     	0018	! DEC ASSUMES  NO  RESPONSIBILITY  FOR  THE  USE  OR  RELIABILITY
     22					;     	0019	! OF ITS  SOFTWARE  ON  EQUIPMENT  WHICH IS NOT  SUPPLIED BY DEC.
     23					;     	0020	!
     24					;     	0021	! WRITTEN BY
     25					;     	0022	!	M. JACK
     26					;     	0023	!
     27					;     	0024	! MODULE FUNCTION
     28					;     	0025	!	TASK-IMAGE PATCHING UTILITY FOR USE WITH RSX-11D AND RSX-11M
     29					;     	0026	!
     30					;     	0027	!
     31					;     	0028
     32					;     	0029	LINKAGE
     33					;     	0030		REG0 = BLISS(REGISTER=0);
     34					;     	0031
     35					;     	0032	FORWARD
     36					;     	0033		OPENLOC,
     37					;     	0034		REG0 ERRPRT;
     38					;     	0035
     39					;     	0036
     40					;     	0037	REQUIRE STDMAC.BEG;
     41					;     	0038	!	STDMAC.BEG - WIDELY USED STANDARD MACROS
     42					;     	0039	!
     43					;     	0057	SWITCHES LIST; SWITCHES LIST;
     44					;     	0058	!	VERSION 000005
     45					;     	0059	!	LAST MODIFIED 05/13/74 RBG
     46					;     	0098	SWITCHES LIST; SWITCHES LIST;
     47					;     	0099	!	STDMAC.BEG LAST LINE
     48					;     	0100
     49					;     	0101	REQUIRE STDSTR.BEG;
     50					;     	0102	!	STDSTR.BEG - WIDELY USED STANDARD STRUCTURES
     51					;     	0103	!
     52					;     	0121	SWITCHES LIST; SWITCHES LIST;
     53					;     	0122	!	VERSION 000003
     54					;     	0123	!	LAST MODIFIED 02/28/74 RBG
     55					;     	0137	SWITCHES LIST; SWITCHES LIST;
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 3


     57					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.16	STDSTR.BEG	PAGE 1-1
     58
     59					;     	0138	!	STDSTR.BEG LAST LINE
     60					;     	0139
     61					;     	0140	REQUIRE ZAP.BEG;
     62					;     	0141	!	ZAP.BEG - BEGIN FILE FOR ZAP
     63					;     	0142	!
     64					;     	0152	SWITCHES LIST; SWITCHES LIST;
     65					;     	0153	!
     66					;     	0154	!	VERSION 000002
     67					;     	0155	!	LAST MODIFIED 09/01/74
     68					;     	0156	!
     69					;     	0157
     70					;     	0158	STRUCTURE
     71					;     	0159		BUFFER[I] = (.BUFFER + .I)<0,16>;
     72					;     	0160
     73					;     	0161	BIND
     74					;     	0162		SEGSIZ=	5,		! LENGTH OF SEGMENT TABLE ENTRY
     75					;     	0163		SEGENT=	64;		! NUMBER OF SEGMENT TABLE ENTRIES
     76					;     	0164
     77					;     	0165	MACRO
     78					;     	0166		SEGBLK=	0,0,16$,	! STARTING DISK BLOCK (SEGMENT "NAME")
     79					;     	0167		SEGLOW=	1,0,16$,	! LOW ADDRESS
     80					;     	0168		SEGHIGH=2,0,16$,	! HIGH ADDRESS PLUS ONE
     81					;     	0169		SEGVIRT=3,0,16$,	! VIRTUAL ORIGIN DATA
     82					;     	0170		SEGVIR1=3,0,16$,	! HIGH ORDER WORD OF SEGVIRT
     83					;     	0171		SEGVIR0=4,0,16$,	! LOW ORDER WORD OF SEGVIRT
     84					;     	0172		SEGVIRW=4,0,9$,		! WORD OFFSET PART OF SEGVIRT
     85					;     	0173		SEGNEXT=5,0,16$;	! OFFSET TO NEXT ENTRY
     86					;     	0174
     87					;     	0175	MACRO
     88					;     	0176		ABSOLUTE=0,0,1$,	! /AB SWITCH BIT
     89					;     	0177		READONLY=0,1,1$,	! /RO SWITCH BIT
     90					;     	0178		LISTING=0,2,1$;		! /LI SWITCH BIT
     91					;     	0179
     92					;     	0180	BIND
     93					;     	0181		NORELO=	0,		! NO SUCH RELOCATION REGISTER
     94					;     	0182		ADROOB=	1,		! ADDRESS NOT WITHIN SEGMENT
     95					;     	0183		NOSEGM=	2,		! NO SUCH SEGMENT
     96					;     	0184		BADARG=	3,		! BAD ARGUMENT COUNT
     97					;     	0185		NOSPEC=	4,		! NO SUCH SPECIAL REGISTER
     98					;     	0186		BADCMD=	5,		! UNRECOGNIZABLE COMMAND
     99					;     	0187		NOOPEN=	6,		! NO OPEN LOCATION
    100					;     	0188		NOBYTE=	7,		! CANNOT USE IN BYTE MODE
    101					;     	0189		BADTSK=	12,		! BAD TASK IMAGE
    102					;     	0190		VFYREJ=	13,		! VERIFY REJECT
    103					;     	0191		NOTYET=	14;		! NOT YET IMPLEMENTED
    104					;     	0192
    105					;     	0193	BIND
    106					;     	0194		SIGXIT=	-1,		! SIGNAL VALUE FOR EXIT
    107					;     	0195		SIGADR=	-2;		! SIGNAL VALUE FOR ADDRESS ERROR
    108					;     	0196
    109					;     	0197	!
    110					;     	0198	!	ZAP.BEG LAST LINE
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 4


    112					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.17	ZAP.BEG	PAGE 1-2
    113
    114					;     	0199
    115					;     	0200
    116					;     	0201	PSECT
    117					;     	0202		CODE=" ", OWN=" ", GLOBAL=" ";
    118					;     	0203
    119					;     	0204	EXTERNAL
    120					;     	0205		ABORT,			! EXIT IMMEDIATELY
    121					;     	0206		FCSCLOSE,		! CLOSE FILES AND EXIT
    122					;     	0207		REG0 FCSREAD,		! READ TASK IMAGE BLOCK
    123					;     	0208		TRANSLATE,		! TRANSLATE SEGMENT-OFFSET TO BLOCK-WORD
    124					;     	0209		REG0 OUTSA,		! OUTPUT ASCIZ STRING
    125					;     	0210		EOL,			! OUTPUT RECORD
    126					;     	0211		ZAPINIT,		! INITIALIZATION CODE
    127					;     	0212		ZAPPROC;		! PROCESSING CODE
    128					;     	0213
    129					;     	0214	EXTERNAL
    130					;     	0215		BLOCK SWITCH;		! COMMAND SWITCHES
    131					;     	0216
    132					;     	0217	GLOBAL
    133					;     	0218		STKLIM = (64),		! SP STACK LIMIT
    134					;     	0219		VECBLOCK SEGTAB[SEGENT,SEGSIZ],	! SEGMENT TABLE
    135					;     	0220		PBLOCK SEGMAX,		! POINT TO FIRST FREE LOC IN SEGTAB
    136					;     	0221		REALDOT;		! POINT TO "DOT" IN BUFFER
    137					;     	0222
    138					;     	0223
    139					;     	0224
    140					;     	0225
    141					;     	0226	COMMENT ! OPENLOC(SEG,ADDR)
    142					;     	0227	!
    143					;     	0228	! FUNCTION
    144					;     	0229	!	OPEN A LOCATION IN TASK ADDRESS SPACE
    145					;     	0230	!
    146					;     	0231	! INPUTS
    147					;     	0232	!	SEG	- THE SEGMENT-ID FOR THE SEGMENT
    148					;     	0233	!	ADDR	- THE ADDRESS IN TASK ADDRESS SPACE
    149					;     	0234	!
    150					;     	0235	! OUTPUTS
    151					;     	0236	!	REALDOT	- THE ADDRESS IN BLOCK BUFFER OF THE WORD OPENED
    152					;     	0237	!	VALUE	- THE CONTENTS OF THE WORD OPENED
    153					;     	0238	!
    154					;     	0239
    155					;     	0240	GLOBAL ROUTINE OPENLOC(SEG,ADDR)=
    156					;     	0241	    BEGIN
    157					;     	0242
    158					;     	0243	    LOCAL
    159					;     	0244		SEGHIT,			! FOUND A SEGMENT-NUMBER MATCH
    160					;     	0245		PBLOCK SEGPTR;
    161					;     	0246
    162					;     	0247	    OWN
    163					;     	0248		TEMP[2];		! TEMPORARY VECTOR
    164					;     	0249
    165					;     	0250	    IF .SWITCH[ABSOLUTE]
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 5


    167					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.17	ZAP.B11	PAGE 1-3
    168
    169					;     	0251	    THEN
    170					;     	0252		BEGIN
    171					;     	0253		IF .SEG EQL 0 THEN SEG = 1;
    172					;     	0254		TEMP[0] = .SEG<7,9>;
    173					;     	0255		TEMP[1] = .SEG * 512;
    174					;     	0256		TRANSLATE(TEMP,.ADDR,TEMP,REALDOT);
    175					;     	0257		FCSREAD(TEMP);
    176					;     	0258		RETURN ..REALDOT;
    177					;     	0259		END
    178					;     	0260	    ELSE
    179					;     	0261		BEGIN
    180					;     	0262		SEGHIT = 0;
    181					;     	0263		SEGPTR = SEGTAB;
    182					;     	0264		DO
    183					;     	0265		    BEGIN
    184					;     	0266		    IF .SEG EQL .SEGPTR[SEGBLK]
    185					;     	0267		    THEN
    186					;     	0268			BEGIN
    187					;     	0269			SEGHIT = .SEGHIT + 1;
    188					;     	0270			IF
    189					;     	0271			    .ADDR GEQU .SEGPTR[SEGLOW] AND
    190					;     	0272			    .ADDR LSSU .SEGPTR[SEGHIGH]
    191					;     	0273			THEN
    192					;     	0274			    BEGIN
    193					;     	0275			    TRANSLATE(SEGPTR[SEGVIRT],.ADDR,TEMP,REALDOT);
    194					;     	0276			    FCSREAD(TEMP);
    195					;     	0277			    RETURN ..REALDOT;
    196					;     	0278			    END
    197					;     	0279			END;
    198					;     	0280		    SEGPTR = SEGPTR[SEGNEXT];
    199					;     	0281		    END
    200					;     	0282		UNTIL
    201					;     	0283		    .SEGPTR GEQU .SEGMAX;
    202					;     	0284		ERRPRT(IF .SEGHIT NEQ 0 THEN ADROOB ELSE NOSEGM);
    203					;     	0285		SIGNAL SIGADR
    204					;     	0286		END;
    205					;     	0287
    206					;     	0288	    END;
    207					;     	0289
    208					.TITLE ZAP
    209					.IDENT /X04.03/
    210	000000				.PSECT
    211
    212
    213		000000 			R$0=%0
    214		000001 			R$1=%1
    215		000002 			R$2=%2
    216		000003 			R$3=%3
    217		000004 			R$4=%4
    218		000005 			R$5=%5
    219		000006 			SP=%6
    220		000007 			PC=%7
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 6


    222					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.21	ZAP.B11	PAGE 1-4
    223
    224
    225
    226	000000				OPENLOC:
    227	000000	004167 	000000G			JSR	R$1,$SAV3
    228	000004	016603 	000014 			MOV	14(SP),R$3
    229	000010	132737 	000001 	000000G		BITB	#1,@#SWITCH
    230	000016	001432 				BEQ	L$3
    231	000020	005703 				TST	R$3
    232	000022	001003 				BNE	L$6
    233	000024	012766 	000001 	000014 		MOV	#1,14(SP)
    234	000032	016602 	000014 		L$6:	MOV	14(SP),R$2
    235	000036	006102 				ROL	R$2
    236	000040	106102 				ROLB	R$2
    237	000042	000302 				SWAB	R$2
    238	000044	042702 	177000 			BIC	#177000,R$2
    239	000050	010267 	000200 			MOV	R$2,TEMP
    240	000054	016602 	000014 			MOV	14(SP),R$2
    241	000060	000302 				SWAB	R$2
    242	000062	105002 				CLRB	R$2
    243	000064	006302 				ASL	R$2
    244	000066	010267 	000164 			MOV	R$2,TEMP+2
    245	000072	012746 	000254'			MOV	#TEMP,-(SP)
    246	000076	016646 	000014 			MOV	14(SP),-(SP)
    247	000102	000422 				BR	L$28
    248	000104	005002 			L$3:	CLR	R$2
    249	000106	012701 	001172'			MOV	#SEGTAB,R$1
    250	000112	020311 			L$9:	CMP	R$3,@R$1
    251	000114	001034 				BNE	L$11
    252	000116	005202 				INC	R$2
    253	000120	016600 	000012 			MOV	12(SP),R$0
    254	000124	020061 	000002 			CMP	R$0,2(R$1)
    255	000130	103426 				BLO	L$11
    256	000132	020061 	000004 			CMP	R$0,4(R$1)
    257	000136	103023 				BHIS	L$11
    258	000140	010146 				MOV	R$1,-(SP)
    259	000142	062716 	000006 			ADD	#6,@SP
    260	000146	010046 				MOV	R$0,-(SP)
    261	000150	012746 	000254'		L$28:	MOV	#TEMP,-(SP)
    262	000154	012746 	001164'			MOV	#REALDOT,-(SP)
    263	000160	004767 	000000G			JSR	PC,TRANSLATE
    264	000164	012700 	000254'			MOV	#TEMP,R$0
    265	000170	004767 	000000G			JSR	PC,FCSREAD
    266	000174	017700 	000764 			MOV	@REALDOT,R$0
    267	000200	062706 	000010 			ADD	#10,SP
    268	000204	000207 				RTS	PC
    269	000206	062701 	000012 		L$11:	ADD	#12,R$1
    270	000212	020137 	001166'			CMP	R$1,@#SEGMAX
    271	000216	103735 				BLO	L$9
    272	000220	005702 				TST	R$2
    273	000222	001403 				BEQ	L$19
    274	000224	012700 	000001 			MOV	#1,R$0
    275	000230	000402 				BR	L$20
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 7


    277					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.21	ZAP.B11	PAGE 1-5
    278
    279	000232	012700 	000002 		L$19:	MOV	#2,R$0
    280	000236	004767 	000016 		L$20:	JSR	PC,ERRPRT
    281	000242	012700 	177776 			MOV	#177776,R$0
    282	000246	000167 	000000G			JMP	$SIGNL
    283	000252	000207 			L$2:	RTS	PC
    284
    285					; ROUTINE SIZE:  86
    286
    287
    288	000254				.PSECT
    289
    290	000254	000260'			TEMP: .=.+4
    291
    292
    293
    294					;     	0290	COMMENT ! ERRPRT(P)
    295					;     	0291	!
    296					;     	0292	! FUNCTION
    297					;     	0293	!	OUTPUT A MESSAGE
    298					;     	0294	!
    299					;     	0295	! INPUTS
    300					;     	0296	!	P	- MESSAGE INDEX
    301					;     	0297	!
    302					;     	0298	! OUTPUTS
    303					;     	0299	!	MESSAGE TYPED ON CONSOLE
    304					;     	0300	!	VALUE	- NONE
    305					;     	0301	!
    306					;     	0302
    307					;     	0303	GLOBAL ROUTINE REG0 ERRPRT(P)=
    308					;     	0304	    BEGIN
    309					;     	0305
    310					;     	0306	    BIND
    311					;     	0307		MESSAGES = UPLIT(
    312					;     	0308		    UPLIT ASCIZ "NO SUCH RELOCATION REGISTER",
    313					;     	0309		    UPLIT ASCIZ "ADDRESS NOT WITHIN SEGMENT",
    314					;     	0310		    UPLIT ASCIZ "NO SUCH SEGMENT",
    315					;     	0311		    UPLIT ASCIZ "TOO MANY ARGUMENTS",
    316					;     	0312		    UPLIT ASCIZ "NO SUCH INTERNAL REGISTER",
    317					;     	0313		    UPLIT ASCIZ "UNRECOGNIZED COMMAND",
    318					;     	0314		    UPLIT ASCIZ "NO OPEN LOCATION",
    319					;     	0315		    UPLIT ASCIZ "CANNOT BE USED IN BYTE MODE",
    320					;     	0316		    UPLIT ASCIZ "ERROR IN FILE SPECIFICATION",
    321					;     	0317		    UPLIT ASCIZ "OPEN FAILURE FOR TASK IMAGE FILE",
    322					;     	0318		    UPLIT ASCIZ "ERROR ON COMMAND INPUT",
    323					;     	0319		    UPLIT ASCIZ "I/O ERROR ON TASK IMAGE FILE",
    324					;     	0320		    UPLIT ASCIZ "NOT A TASK IMAGE FILE",
    325					;     	0321		    UPLIT ASCIZ "VERIFY FAILURE",
    326					;     	0322		    UPLIT ASCIZ "NOT IMPLEMENTED");
    327					;     	0323
    328					;     	0324	    OUTSA(.MESSAGES[.P]);
    329					;     	0325	    EOL();
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 8


    331					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.22	ZAP.B11	PAGE 1-6
    332
    333					;     	0326	    NOVALUE
    334					;     	0327	    END;
    335					;     	0328
    336
    337	000260				.PSECT
    338
    339
    340	000260				ERRPRT:
    341	000260	006300 				ASL	R$0
    342	000262	016000 	000604'			MOV	P$AAB(R$0),R$0
    343	000266	004767 	000000G			JSR	PC,OUTSA
    344	000272	000167 	000000G			JMP	EOL
    345
    346					; ROUTINE SIZE:  7
    347
    348
    349	000276				.PSECT
    350
    351	000276	040503 	047116 	052117 	P$AAJ:	.WORD  40503,47116,52117
    352	000304	041040 	020105 	051525 		.WORD  41040,20105,51525
    353	000312	042105 	044440 	020116 		.WORD  42105,44440,20116
    354	000320	054502 	042524 	046440 		.WORD  54502,42524,46440
    355	000326	042117 	000105 			.WORD  42117,105
    356	000332	051105 	047522 	020122 	P$AAK:	.WORD  51105,47522,20122
    357	000340	047111 	043040 	046111 		.WORD  47111,43040,46111
    358	000346	020105 	050123 	041505 		.WORD  20105,50123,41505
    359	000354	043111 	041511 	052101 		.WORD  43111,41511,52101
    360	000362	047511 	000116 			.WORD  47511,116
    361	000366	050117 	047105 	043040 	P$AAL:	.WORD  50117,47105,43040
    362	000374	044501 	052514 	042522 		.WORD  44501,52514,42522
    363	000402	043040 	051117 	052040 		.WORD  43040,51117,52040
    364	000410	051501 	020113 	046511 		.WORD  51501,20113,46511
    365	000416	043501 	020105 	044506 		.WORD  43501,20105,44506
    366	000424	042514 	000000 			.WORD  42514,0
    367	000430	051105 	047522 	020122 	P$AAM:	.WORD  51105,47522,20122
    368	000436	047117 	041440 	046517 		.WORD  47117,41440,46517
    369	000444	040515 	042116 	044440 		.WORD  40515,42116,44440
    370	000452	050116 	052125 	000000 		.WORD  50116,52125,0
    371	000460	027511 	020117 	051105 	P$AAN:	.WORD  27511,20117,51105
    372	000466	047522 	020122 	047117 		.WORD  47522,20122,47117
    373	000474	052040 	051501 	020113 		.WORD  52040,51501,20113
    374	000502	046511 	043501 	020105 		.WORD  46511,43501,20105
    375	000510	044506 	042514 	000000 		.WORD  44506,42514,0
    376	000516	047516 	020124 	020101 	P$AAO:	.WORD  47516,20124,20101
    377	000524	040524 	045523 	044440 		.WORD  40524,45523,44440
    378	000532	040515 	042507 	043040 		.WORD  40515,42507,43040
    379	000540	046111 	000105 			.WORD  46111,105
    380	000544	042526 	044522 	054506 	P$AAP:	.WORD  42526,44522,54506
    381	000552	043040 	044501 	052514 		.WORD  43040,44501,52514
    382	000560	042522 	000000 			.WORD  42522,0
    383	000564	047516 	020124 	046511 	P$AAQ:	.WORD  47516,20124,46511
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 9


    385					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.24	ZAP.B11	PAGE 1-7
    386
    387	000572	046120 	046505 	047105 		.WORD  46120,46505,47105
    388	000600	042524 	000104 			.WORD  42524,104
    389	000604	000642'	000676'	000732'	P$AAB:	.WORD  P$AAC,P$AAD,P$AAE
    390	000612	000752'	000776'	001030'		.WORD  P$AAF,P$AAG,P$AAH
    391	000620	001056'	000276'	000332'		.WORD  P$AAI,P$AAJ,P$AAK
    392	000626	000366'	000430'	000460'		.WORD  P$AAL,P$AAM,P$AAN
    393	000634	000516'	000544'	000564'		.WORD  P$AAO,P$AAP,P$AAQ
    394	000642	047516 	051440 	041525 	P$AAC:	.WORD  47516,51440,41525
    395	000650	020110 	042522 	047514 		.WORD  20110,42522,47514
    396	000656	040503 	044524 	047117 		.WORD  40503,44524,47117
    397	000664	051040 	043505 	051511 		.WORD  51040,43505,51511
    398	000672	042524 	000122 			.WORD  42524,122
    399	000676	042101 	051104 	051505 	P$AAD:	.WORD  42101,51104,51505
    400	000704	020123 	047516 	020124 		.WORD  20123,47516,20124
    401	000712	044527 	044124 	047111 		.WORD  44527,44124,47111
    402	000720	051440 	043505 	042515 		.WORD  51440,43505,42515
    403	000726	052116 	000000 			.WORD  52116,0
    404	000732	047516 	051440 	041525 	P$AAE:	.WORD  47516,51440,41525
    405	000740	020110 	042523 	046507 		.WORD  20110,42523,46507
    406	000746	047105 	000124 			.WORD  47105,124
    407	000752	047524 	020117 	040515 	P$AAF:	.WORD  47524,20117,40515
    408	000760	054516 	040440 	043522 		.WORD  54516,40440,43522
    409	000766	046525 	047105 	051524 		.WORD  46525,47105,51524
    410	000774	000000 				.WORD  0
    411	000776	047516 	051440 	041525 	P$AAG:	.WORD  47516,51440,41525
    412	001004	020110 	047111 	042524 		.WORD  20110,47111,42524
    413	001012	047122 	046101 	051040 		.WORD  47122,46101,51040
    414	001020	043505 	051511 	042524 		.WORD  43505,51511,42524
    415	001026	000122 				.WORD  122
    416	001030	047125 	042522 	047503 	P$AAH:	.WORD  47125,42522,47503
    417	001036	047107 	055111 	042105 		.WORD  47107,55111,42105
    418	001044	041440 	046517 	040515 		.WORD  41440,46517,40515
    419	001052	042116 	000000 			.WORD  42116,0
    420	001056	047516 	047440 	042520 	P$AAI:	.WORD  47516,47440,42520
    421	001064	020116 	047514 	040503 		.WORD  20116,47514,40503
    422	001072	044524 	047117 	000000 		.WORD  44524,47117,0
    423
    424
    425
    426					;     	0329	COMMENT ! MAIN PROGRAM
    427					;     	0330	!
    428					;     	0331	! FUNCTION
    429					;     	0332	!	ACTS AS THE DRIVER PROGRAM
    430					;     	0333	!
    431					;     	0334
    432					;     	0335	    ENABLE
    433					;     	0336		ALWAYS:
    434					;     	0337		    BEGIN
    435					;     	0338		    ENABLE
    436					;     	0339			ALWAYS:  ABORT()
    437					;     	0340		    ELBANE;
    438					;     	0341		    FCSCLOSE()
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 10


    440					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.26	ZAP.B11	PAGE 1-8
    441
    442					;     	0342		    END
    443					;     	0343	    ELBANE;
    444					;     	0344
    445					;     	0345	    ZAPINIT();
    446					;     	0346	    ZAPPROC()
    447					;     	0347
    448					;     	0348	END
    449					;     	0349	ELUDOM
    450
    451	001100				.PSECT
    452
    453
    454	001100				ZAP:
    455	001100	162706 	000014 			SUB	#14,SP
    456	001104	012700 	000014 			MOV	#14,R$0
    457	001110	004767 	000000G			JSR	PC,$ENABL
    458	001114	000026 				.WORD	L$33-L$32
    459	001116	012700 	000006 		L$32:	MOV	#6,R$0
    460	001122	004767 	000000G			JSR	PC,$ENABL
    461	001126	000006 				.WORD	L$35-L$34
    462	001130	004767 	000000G		L$34:	JSR	PC,ABORT
    463	001134	000000 				HALT
    464	001136	004767 	000000G		L$35:	JSR	PC,FCSCLOSE
    465	001142	000404 				BR	L$36
    466	001144	004767 	000000G		L$33:	JSR	PC,ZAPINIT
    467	001150	004767 	000000G			JSR	PC,ZAPPROC
    468	001154	017767 	000000G	000000G	L$36:	MOV	@SIGREG,SIGREG
    469	001162	000000 			U$36:	HALT
    470
    471					; ROUTINE SIZE:  26
    472
    473
    474	001164				.PSECT
    475
    476	001164	001166'			REALDOT: .=.+2
    477	001166	001170'			SEGMAX: .=.+2
    478	001170	000100 			STKLIM:	.WORD  100
    479	001172	002372'			SEGTAB: .=.+1200
    480					.GLOBL ZAPINIT
    481					.GLOBL FCSCLOSE
    482					.GLOBL REALDOT
    483					.GLOBL OUTSA
    484					.GLOBL SEGMAX
    485					.GLOBL ZAPPROC
    486					.GLOBL ABORT
    487					.GLOBL STKLIM
    488					.GLOBL EOL
    489					.GLOBL FCSREAD
    490					.GLOBL SEGTAB
    491					.GLOBL TRANSLATE
    492					.GLOBL SWITCH
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 11


    494					; BLIS11 V.74206	SUNDAY 13-APR-75 1:41.28	ZAP.B11	PAGE 1-9
    495
    496					.GLOBL ERRPRT
    497					.GLOBL OPENLOC
    498
    499					.GLOBL $ENABL
    500					.GLOBL $SIGN1
    501					.GLOBL $SIGNL
    502					.GLOBL $SAV3
    503					.GLOBL SIGREG
    504					.GLOBL SIGVAL
    505
    506
    507
    508
    509
    510
    511
    512
    513
    514					; SIZE:  119+518
    515					; RUN TIME:  6 SECONDS
    516					; CORE USED:  16K
    517					; COMPILATION COMPLETE
    518
    519		001100'			.END ZAP
ZAP	MACRO M1113  14-APR-81 11:46  PAGE 11-1
SYMBOL TABLE

ABORT = ****** G 	L$33    001144R  	P$AAF   000752R  	REALDO  001164RG 	SWITCH= ****** G
EOL   = ****** G 	L$34    001130R  	P$AAG   000776R  	R$0   =%000000   	TEMP    000254R
ERRPRT  000260RG 	L$35    001136R  	P$AAH   001030R  	R$1   =%000001   	TRANSL= ****** G
FCSCLO= ****** G 	L$36    001154R  	P$AAI   001056R  	R$2   =%000002   	U$36    001162R
FCSREA= ****** G 	L$6     000032R  	P$AAJ   000276R  	R$3   =%000003   	ZAP     001100R
L$11    000206R  	L$9     000112R  	P$AAK   000332R  	R$4   =%000004   	ZAPINI= ****** G
L$19    000232R  	OPENLO  000000RG 	P$AAL   000366R  	R$5   =%000005   	ZAPPRO= ****** G
L$2     000252R  	OUTSA = ****** G 	P$AAM   000430R  	SEGMAX  001166RG 	$ENABL= ****** G
L$20    000236R  	P$AAB   000604R  	P$AAN   000460R  	SEGTAB  001172RG 	$SAV3 = ****** G
L$28    000150R  	P$AAC   000642R  	P$AAO   000516R  	SIGREG= ****** G 	$SIGNL= ****** G
L$3     000104R  	P$AAD   000676R  	P$AAP   000544R  	SIGVAL= ****** G 	$SIGN1= ****** G
L$32    001116R  	P$AAE   000732R  	P$AAQ   000564R  	STKLIM  001170RG

. ABS.	000000	   000
      	002372	   001
ERRORS DETECTED:  0

VIRTUAL MEMORY USED:  341 WORDS  ( 2 PAGES)
DYNAMIC MEMORY:  2518 WORDS  ( 9 PAGES)
ELAPSED TIME:  00:00:06
[62,10]ZAP,[62,20]ZAP/-SP/CR=[62,30]ZAP.P11
ZAP        CREATED BY  MACRO  ON 14-APR-81 AT 11:46	PAGE 1

SYMBOL CROSS REFERENCE                                  CREF         

SYMBOL	VALUE		REFERENCES

ABORT 	= ******  G	 10-462     10-486    
EOL   	= ******  G	 8-344      10-488    
ERRPRT	  000260 RG	 7-280     #8-340      11-496    
FCSCLO	= ******  G	 10-464     10-481    
FCSREA	= ******  G	 6-265      10-489    
L$11  	  000206 R	 6-251      6-255      6-257     #6-269     
L$19  	  000232 R	 6-273     #7-279     
L$2   	  000252 R	#7-283     
L$20  	  000236 R	 6-275     #7-280     
L$28  	  000150 R	 6-247     #6-261     
L$3   	  000104 R	 6-230     #6-248     
L$32  	  001116 R	 10-458    #10-459    
L$33  	  001144 R	 10-458    #10-466    
L$34  	  001130 R	 10-461    #10-462    
L$35  	  001136 R	 10-461    #10-464    
L$36  	  001154 R	 10-465    #10-468    
L$6   	  000032 R	 6-232     #6-234     
L$9   	  000112 R	#6-250      6-271     
OPENLO	  000000 RG	#6-226      11-497    
OUTSA 	= ******  G	 8-343      10-483    
P$AAB 	  000604 R	 8-342     #9-389     
P$AAC 	  000642 R	 9-389     #9-394     
P$AAD 	  000676 R	 9-389     #9-399     
P$AAE 	  000732 R	 9-389     #9-404     
P$AAF 	  000752 R	 9-390     #9-407     
P$AAG 	  000776 R	 9-390     #9-411     
P$AAH 	  001030 R	 9-390     #9-416     
P$AAI 	  001056 R	 9-391     #9-420     
P$AAJ 	  000276 R	#8-351      9-391     
P$AAK 	  000332 R	#8-356      9-391     
P$AAL 	  000366 R	#8-361      9-392     
P$AAM 	  000430 R	#8-367      9-392     
P$AAN 	  000460 R	#8-371      9-392     
P$AAO 	  000516 R	#8-376      9-393     
P$AAP 	  000544 R	#8-380      9-393     
P$AAQ 	  000564 R	#8-383      9-393     
REALDO	  001164 RG	 6-262      6-266     #10-476     10-482    
R$0   	=%000000	#5-213     *6-253      6-254      6-256      6-260     *6-264     *6-266     *6-274     *7-279     
                        *7-281     *8-341      8-342     *8-342     *10-456    *10-459    
R$1   	=%000001	#5-214     *6-227     *6-249      6-250      6-254      6-256      6-258     *6-269      6-270     
R$2   	=%000002	#5-215     *6-234     *6-235     *6-236     *6-237     *6-238      6-239     *6-240     *6-241     
                        *6-242     *6-243      6-244     *6-248     *6-252      6-272     
R$3   	=%000003	#5-216     *6-228      6-231      6-250     
R$4   	=%000004	#5-217     
R$5   	=%000005	#5-218     
SEGMAX	  001166 RG	 6-270     #10-477     10-484    
SEGTAB	  001172 RG	 6-249     #10-479     10-490    
SIGREG	= ******  G	 10-468    *10-468     11-503    
SIGVAL	= ******  G	 11-504    
STKLIM	  001170 RG	#10-478     10-487    
SWITCH	= ******  G	 6-229      10-492    
TEMP  	  000254 R	*6-239     *6-244      6-245      6-261      6-264     #7-290     
ZAP        CREATED BY  MACRO  ON 14-APR-81 AT 11:46	PAGE 2

SYMBOL CROSS REFERENCE                                  CREF         

SYMBOL	VALUE		REFERENCES

TRANSL	= ******  G	 6-263      10-491    
U$36  	  001162 R	#10-469    
ZAP   	  001100 R	#10-454     11-519    
ZAPINI	= ******  G	 10-466     10-480    
ZAPPRO	= ******  G	 10-467     10-485    
$ENABL	= ******  G	 10-457     10-460     11-499    
$SAV3 	= ******  G	 6-227      11-502    
$SIGNL	= ******  G	 7-282      11-501    
$SIGN1	= ******  G	 11-500    
